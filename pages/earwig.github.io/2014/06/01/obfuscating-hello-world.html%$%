<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Obfuscating "Hello world!" - Earwig</title>
        <link rel="stylesheet" href="/css/main.css" type="text/css" />
        <link rel="stylesheet" href="/css/syntax.css" type="text/css" /> <!-- shamelessly stolen from https://github.com/mojombo/tpw/blob/master/css/syntax.css -->
        <script src="/js/date_format.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <div id="container">
            <div id="header">
    <h1 id="head"><a class="incognito" href="/">Obfuscating "Hello world!"</a></h1>
</div>
<div id="content">
    <div id="post-info" class="description">
        <span class="color-highlight">Date:</span> Sun, Jun 01, 2014
    </div>
    <div id="post">
        <p>A few months ago, I got first place in
<a href="//codegolf.stackexchange.com/q/22533">this Code Golf contest</a> to create the
weirdest obfuscated program that prints the string “Hello world!”. I decided to
write up an explanation of how the hell it works. So, here’s the entry, in
Python 2.7:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span>
    <span class="nb">getattr</span><span class="p">(</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">__</span><span class="p">]),</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="n">__</span><span class="p">]</span> <span class="o">+</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">_____</span><span class="p">:</span><span class="n">________</span><span class="p">]</span>
    <span class="p">)(</span>
        <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
                <span class="nb">chr</span><span class="p">(</span><span class="n">___</span> <span class="o">%</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span> <span class="o">//</span> <span class="n">__</span><span class="p">)</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span>
                <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_lnotab</span><span class="p">,</span>
            <span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">________</span><span class="p">,</span>
            <span class="p">(((</span><span class="n">_____</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">_____</span><span class="p">)</span> <span class="o">-</span> <span class="n">___</span><span class="p">))</span> <span class="o">+</span> <span class="p">(((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">_____</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span>
            <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span>
            <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">______</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span>
            <span class="p">((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span>
            <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="p">((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">_______</span>
            <span class="o">&lt;&lt;</span> <span class="p">(((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)))</span> <span class="o">-</span> <span class="p">((((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span>
            <span class="p">(((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">_____</span> <span class="o">&lt;&lt;</span>
            <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">_____</span> <span class="o">&lt;&lt;</span> <span class="n">______</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)(</span>
    <span class="o">*</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
            <span class="p">[</span><span class="n">__</span><span class="p">(</span><span class="n">___</span><span class="p">[(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">])]</span> <span class="o">+</span>
            <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">[(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">:])</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">),</span>
        <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">,</span>
        <span class="p">(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span> <span class="n">_</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>String literals weren’t allowed, but I set some other restrictions for fun: it
had to be a single expression (so no <code>print</code> statement) with minimal builtin
usage and no integer literals.</p>

<h2 id="getting-started">Getting started</h2>

<p>Since we can’t use <code>print</code>, we can write to the <code>stdout</code> file object:</p>

<div class="highlight"><pre><code class="python"><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>But let’s use something lower-level:
<a href="//docs.python.org/2/library/os.html#os.write"><code>os.write()</code></a>. We need
<code>stdout</code>’s <a href="//en.wikipedia.org/wiki/File_descriptor">file descriptor</a>, which is
<code>1</code> (you can check with <code>print sys.stdout.fileno()</code>).</p>

<div class="highlight"><pre><code class="python"><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>We want a single expression, so we’ll use
<a href="//docs.python.org/2/library/functions.html#__import__"><code>__import__()</code></a>:</p>

<div class="highlight"><pre><code class="python"><span class="nb">__import__</span><span class="p">(</span><span class="s">&quot;os&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>We also want to be able to obfuscate the <code>write()</code>, so we’ll throw in a
<code>getattr()</code>:</p>

<div class="highlight"><pre><code class="python"><span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="s">&quot;os&quot;</span><span class="p">),</span> <span class="s">&quot;write&quot;</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>This is the starting point. Everything from now on will be obfuscating the
three strings and the int.</p>

<h2 id="stringing-together-strings">Stringing together strings</h2>

<p><code>"os"</code> and <code>"write"</code> are fairly simple, so we’ll create them by joining parts
of the names of various built-in classes. There are many different ways to do
this, but I chose the following:</p>

<ul>
  <li><code>"o"</code> from the second letter of <code>bool</code>: <code>True.__class__.__name__[1]</code></li>
  <li><code>"s"</code> from the third letter of <code>list</code>: <code>[].__class__.__name__[2]</code></li>
  <li><code>"wr"</code> from the first two letters of <code>wrapper_descriptor</code>, an implementation
detail in CPython found as the type of some builtin classes’ methods (more on
that
<a href="http://utcc.utoronto.ca/~cks/space/blog/python/SlotWrapperObjects">here</a>):
<code>().__class__.__eq__.__class__.__name__[:2]</code></li>
  <li><code>"ite"</code> from the sixth through eighth letters of <code>tupleiterator</code>, the type of
object returned by calling <code>iter()</code> on a tuple:
<code>().__iter__().__class__.__name__[5:8]</code></li>
</ul>

<p>We’re starting to make some progress!</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python">1
2
3
4
5</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">getattr</span><span class="p">(</span>
    <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
    <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><code>"Hello world!\n"</code> is more complicated. We’re going to encode it as a big
integer, which will be formed of the ASCII code of each character multiplied by
256 to the power of the character’s index in the string. In other words, the
following series:</p>

<div>$$\sum_{n=0}^{L-1} c_n(256^n)$$</div>

<p>where <span>\(L\)</span> is the length of the string and
<span>\(c_n\)</span> is the ASCII code of the
<span>\(n\)</span><sup>th</sup> character in the string. To create the
number:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">**</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">codes</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">num</span>
<span class="go">802616035175250124568770929992</span>
</code></pre></div>

<p>Now we need the code to convert this number back into a string. We use a simple
recursive algorithm:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span> <span class="o">+</span> <span class="n">convert</span><span class="p">(</span><span class="n">num</span> <span class="o">//</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span><span class="p">(</span><span class="mi">802616035175250124568770929992</span><span class="p">)</span>
<span class="go">&#39;Hello world!\n&#39;</span>
</code></pre></div>

<p>Rewriting in one line with <code>lambda</code>:</p>

<div class="highlight"><pre><code class="python"><span class="n">convert</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span> <span class="o">+</span> <span class="n">convert</span><span class="p">(</span><span class="n">num</span> <span class="o">//</span> <span class="mi">256</span><span class="p">)</span> <span class="k">if</span> <span class="n">num</span> <span class="k">else</span> <span class="s">&quot;&quot;</span>
</code></pre></div>

<p>Now we use
<a href="//en.wikipedia.org/wiki/Anonymous_recursion">anonymous recursion</a> to turn this
into a single expression. This requires a
<a href="//en.wikipedia.org/wiki/Combinatory_logic">combinator</a>. Start with this:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="n">comb</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">256</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="k">else</span> <span class="s">&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comb</span><span class="p">(</span><span class="n">convert</span><span class="p">,</span> <span class="mi">802616035175250124568770929992</span><span class="p">)</span>
<span class="go">&#39;Hello world!\n&#39;</span>
</code></pre></div>

<p>Now we just substitute the two definitions into the expression, and we have our
function:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">))(</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">256</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mi">802616035175250124568770929992</span><span class="p">)</span>
<span class="go">&#39;Hello world!\n&#39;</span>
</code></pre></div>

<p>Now we can stick this into our code from before, replacing some variable names
along the way (<code>f</code> → <code>_</code>, <code>n</code> → <code>__</code>):</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">getattr</span><span class="p">(</span>
    <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
    <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="p">)(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">))(</span>
        <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="n">__</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span> <span class="o">//</span> <span class="mi">256</span><span class="p">)</span> <span class="k">if</span> <span class="n">__</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
        <span class="mi">802616035175250124568770929992</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<h2 id="function-internals">Function internals</h2>

<p>We’re left with a <code>""</code> in the body of our convert function (remember: no string
literals!), and a large number that we’ll have to hide somehow. Let’s start
with the empty string. We can make one on the fly by examining the internals of
some random function:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_lnotab</span>
<span class="go">&#39;&#39;</span>
</code></pre></div>

<p>What we’re <em>really</em> doing here is looking at the
<a href="http://svn.python.org/projects/python/branches/pep-0384/Objects/lnotab_notes.txt">line number table</a>
of the <code>code</code> object contained within the function. Since it’s anonymous, there
are no line numbers, so the string is empty. Replace the <code>0</code> with <code>_</code> to make
it more confusing (it doesn’t matter, since the function’s not being called),
and stick it in. We’ll also refactor out the <code>256</code> into an argument that gets
passed to our obfuscated <code>convert()</code> along with the number. This requires
adding an argument to the combinator:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">getattr</span><span class="p">(</span>
    <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
    <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="p">)(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
        <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
            <span class="nb">chr</span><span class="p">(</span><span class="n">___</span> <span class="o">%</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span> <span class="o">//</span> <span class="n">__</span><span class="p">)</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span>
            <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_lnotab</span><span class="p">,</span>
        <span class="mi">256</span><span class="p">,</span>
        <span class="mi">802616035175250124568770929992</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<h2 id="a-detour">A detour</h2>

<p>Let’s tackle a different problem for a bit. We want a way to obfuscate the
numbers in our code, but it’ll be cumbersome (and not particularly interesting)
to recreate them each time they’re used. If we can implement, say,
<code>range(1, 9) == [1, 2, 3, 4, 5, 6, 7, 8]</code>, then we can wrap our current work in
a function that takes variables containing the numbers from 1 to 8, and replace
occurrences of integer literals in the body with these variables:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">n4</span><span class="p">,</span> <span class="n">n5</span><span class="p">,</span> <span class="n">n6</span><span class="p">,</span> <span class="n">n7</span><span class="p">,</span> <span class="n">n8</span><span class="p">:</span>
    <span class="nb">getattr</span><span class="p">(</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">n1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">n2</span><span class="p">]),</span>
        <span class="o">...</span>
    <span class="p">)(</span>
        <span class="o">...</span>
    <span class="p">)</span>
<span class="p">)(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<p>Even though we need to form <code>256</code> and <code>802616035175250124568770929992</code> as well,
these can be created using arithmetic operations on these eight “fundamental”
numbers. The choice of 1–8 is arbitrary, but seems to be a good middle ground.</p>

<p>We can get the number of arguments a function takes via its <code>code</code> object:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span>
<span class="go">3</span>
</code></pre></div>

<p>Build a tuple of functions with argcounts between 1 and 8:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="n">funcs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span> <span class="n">_</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Using a recursive algorithm, we can turn this into the output of <code>range(1, 9)</code>:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">]</span> <span class="o">+</span> <span class="n">convert</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">[]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8]</span>
</code></pre></div>

<p>As before, we convert this into <code>lambda</code> form:</p>

<div class="highlight"><pre><code class="python"><span class="n">convert</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">]</span> <span class="o">+</span> <span class="n">convert</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="k">if</span> <span class="n">L</span> <span class="k">else</span> <span class="p">[]</span>
</code></pre></div>

<p>Then, into anonymous-recursive form:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">L</span><span class="p">))(</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="k">if</span> <span class="n">L</span> <span class="k">else</span> <span class="p">[],</span>
<span class="gp">... </span>    <span class="n">funcs</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8]</span>
</code></pre></div>

<p>For fun, we’ll factor out argcount operation into an additional function
argument, and obfuscate some variable names:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python">1
2
3
4
5
6
7</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
        <span class="p">[</span><span class="n">__</span><span class="p">(</span><span class="n">___</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="p">),</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">,</span>
    <span class="n">funcs</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>There’s a new problem now: we still need a way to hide <code>0</code> and <code>1</code>. We can get
these by examining the number of local variables within arbitrary functions:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span>
<span class="go">1</span>
</code></pre></div>

<p>Even though the function bodies look the same, <code>_</code> in the first function is not
an argument, nor is it defined in the function, so Python interprets it as a
global variable:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span>
<span class="go">  1           0 LOAD_GLOBAL              0 (_)</span>
<span class="go">              3 RETURN_VALUE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span>
<span class="go">  1           0 LOAD_FAST                0 (_)</span>
<span class="go">              3 RETURN_VALUE</span>
</code></pre></div>

<p>This happens regardless of whether <code>_</code> is actually defined in the global scope.</p>

<p>Putting this into practice:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
        <span class="p">[</span><span class="n">__</span><span class="p">(</span><span class="n">___</span><span class="p">[(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">])]</span> <span class="o">+</span>
        <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">[(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">:])</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="p">),</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">,</span>
    <span class="n">funcs</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Now we can substitute the value of <code>funcs</code> in, and then using <code>*</code> to pass the
resulting list of integers as eight separate variables, we get this:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">n4</span><span class="p">,</span> <span class="n">n5</span><span class="p">,</span> <span class="n">n6</span><span class="p">,</span> <span class="n">n7</span><span class="p">,</span> <span class="n">n8</span><span class="p">:</span>
    <span class="nb">getattr</span><span class="p">(</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">n1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">n2</span><span class="p">]),</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="n">n2</span><span class="p">]</span> <span class="o">+</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">n5</span><span class="p">:</span><span class="n">n8</span><span class="p">]</span>
    <span class="p">)(</span>
        <span class="n">n1</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
                <span class="nb">chr</span><span class="p">(</span><span class="n">___</span> <span class="o">%</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span> <span class="o">//</span> <span class="n">__</span><span class="p">)</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span>
                <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_lnotab</span><span class="p">,</span>
            <span class="mi">256</span><span class="p">,</span>
            <span class="mi">802616035175250124568770929992</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)(</span>
    <span class="o">*</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
            <span class="p">[</span><span class="n">__</span><span class="p">(</span><span class="n">___</span><span class="p">[(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">])]</span> <span class="o">+</span>
            <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">[(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">:])</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">),</span>
        <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">,</span>
        <span class="p">(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span> <span class="n">_</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<h2 id="shifting-bits">Shifting bits</h2>

<p>Almost there! We’ll replace the <code>n{1..8}</code> variables with <code>_</code>, <code>__</code>, <code>___</code>,
<code>____</code>, etc., since it creates confusion with the variables used in our inner
functions. This doesn’t cause actual problems, since scoping rules mean the
right ones will be used. This is also one of the reasons why we refactored
<code>256</code> out to where <code>_</code> refers to <code>1</code> instead of our obfuscated <code>convert()</code>
function. It’s getting long, so I’ll paste only the first half:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span>
    <span class="nb">getattr</span><span class="p">(</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">__</span><span class="p">]),</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="n">__</span><span class="p">]</span> <span class="o">+</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">_____</span><span class="p">:</span><span class="n">________</span><span class="p">]</span>
    <span class="p">)(</span>
        <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
                <span class="nb">chr</span><span class="p">(</span><span class="n">___</span> <span class="o">%</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span> <span class="o">//</span> <span class="n">__</span><span class="p">)</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span>
                <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_lnotab</span><span class="p">,</span>
            <span class="mi">256</span><span class="p">,</span>
            <span class="mi">802616035175250124568770929992</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Only two more things are left. We’ll start with the easy one: <code>256</code>.
<span>\(256 = 2^8\)</span>, so we can rewrite it as <code>1 &lt;&lt; 8</code> (using a
<a href="//stackoverflow.com/a/141873">left bit shift</a>), or <code>_ &lt;&lt; ________</code> with our
obfuscated variables.</p>

<p>We’ll use the same idea with <code>802616035175250124568770929992</code>. A simple
divide-and-conquer algorithm can break it up into sums of numbers which are
themselves sums of numbers that are shifted together, and so on. For example,
if we had <code>112</code>, we could break it up into <code>96 + 16</code> and then
<code>(3 &lt;&lt; 5) + (2 &lt;&lt; 3)</code>. I like using bit shifts because the <code>&lt;&lt;</code> reminds me of
<code>std::cout &lt;&lt; "foo"</code> in C++, or
<a href="//docs.python.org/2/reference/simple_stmts.html#the-print-statement"><code>print</code> chevron</a>
(<code>print &gt;&gt;</code>) in Python, both of which are red herrings involving other ways of
doing I/O.</p>

<p>The number can be decomposed in a variety of ways; no one method is correct
(after all, we could just break it up into <code>(1 &lt;&lt; 0) + (1 &lt;&lt; 0) + ...</code>, but
that’s not interesting). We should have some substantial amount of nesting, but
still use most of our numerical variables. Obviously, doing this by hand isn’t
fun, so we’ll come up with an algorithm. In pseudocode:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="text"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</code></pre></div></td><td class="code"><div class="highlight"><pre>func encode(num):
    if num &lt;= 8:
        return &quot;_&quot; * num
    else:
        return &quot;(&quot; + convert(num) + &quot;)&quot;

func convert(num):
    base = shift = 0
    diff = num
    span = ...
    for test_base in range(span):
        for test_shift in range(span):
            test_diff = |num| - (test_base &lt;&lt; test_shift)
            if |test_diff| &lt; |diff|:
                diff = test_diff
                base = test_base
                shift = test_shift
    encoded = &quot;(&quot; + encode(base) + &quot; &lt;&lt; &quot; + encode(shift) + &quot;)&quot;
    if diff == 0:
        return encoded
    else:
        return encoded + &quot; + &quot; + convert(diff)

convert(802616035175250124568770929992)
</pre></div>
</td></tr></table>

<p>The basic idea here is that we test various combinations of numbers in a
certain range until we come up with two numbers, <code>base</code> and <code>shift</code>,
such that <code>base &lt;&lt; shift</code> is as closest to <code>num</code> as possible (i.e. we minimize
their absolute difference, <code>diff</code>). We then use our divide-and-conquer
algorithm to break up <code>best_base</code> and <code>best_shift</code>, and then repeat the
procedure on <code>diff</code> until it reaches zero, summing the terms along the way.</p>

<p>The argument to <code>range()</code>, <code>span</code>, represents the width of the search space.
This can’t be too large, or we’ll end getting <code>num</code> as our <code>base</code> and <code>0</code> as
our <code>shift</code> (because <code>diff</code> is zero), and since <code>base</code> can’t be represented as
a single variable, it’ll repeat, recursing infinitely. If it’s too small, we’ll
end up with something like the <code>(1 &lt;&lt; 0) + (1 &lt;&lt; 0) + ...</code> mentioned above. In
practice, we want <code>span</code> to get smaller as the recursion depth increases.
Through trial and error, I found this equation to work well:</p>

<div>$$\mathit{span} = \lceil\log_{1.5} \lvert{\mathit{num}}\lvert\rceil + \lfloor2^{4-\mathit{depth}}\rfloor$$</div>

<p>Translating the pseudocode into Python and making some tweaks (support for the
<code>depth</code> argument, and some caveats involving negative numbers), we get this:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">log</span>

<span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;_ - _&quot;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;_&quot;</span> <span class="o">*</span> <span class="n">num</span>
    <span class="k">return</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">convert</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>

<span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">while</span> <span class="n">num</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">num</span>
        <span class="n">span</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">16</span> <span class="o">&gt;&gt;</span> <span class="n">depth</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">test_base</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">span</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">test_shift</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">span</span><span class="p">):</span>
                <span class="n">test_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">test_base</span> <span class="o">&lt;&lt;</span> <span class="n">test_shift</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">test_diff</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">):</span>
                    <span class="n">diff</span> <span class="o">=</span> <span class="n">test_diff</span>
                    <span class="n">base</span> <span class="o">=</span> <span class="n">test_base</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="n">test_shift</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot; + &quot;</span> <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s">&quot; - &quot;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="o">-</span><span class="n">base</span>
        <span class="k">if</span> <span class="n">shift</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">encode</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;(</span><span class="si">%s</span><span class="s"> &lt;&lt; </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">depth</span><span class="p">),</span>
                                      <span class="n">encode</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="n">depth</span><span class="p">))</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">diff</span> <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="n">diff</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</td></tr></table>

<p>Now, when we call <code>convert(802616035175250124568770929992)</code>, we get a nice
decomposition:</p>

<div class="highlight"><pre><code class="pycon"><span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span><span class="p">(</span><span class="mi">802616035175250124568770929992</span><span class="p">)</span>
<span class="go">(((_____ &lt;&lt; ____) + _) &lt;&lt; ((___ &lt;&lt; _____) - ___)) + (((((___ &lt;&lt; __) - _) &lt;&lt; ___) + _) &lt;&lt; ((_____ &lt;&lt; ____) + (_ &lt;&lt; _))) + (((_______ &lt;&lt; __) - _) &lt;&lt; (((((_ &lt;&lt; ___) + _)) &lt;&lt; ___) + (_ &lt;&lt; _))) + (((_______ &lt;&lt; ___) + _) &lt;&lt; ((_ &lt;&lt; ______) + _)) + (((_______ &lt;&lt; ____) - _) &lt;&lt; ((_______ &lt;&lt; ___))) + (((_ &lt;&lt; ____) - _) &lt;&lt; ((((___ &lt;&lt; __) + _) &lt;&lt; __) - _)) - (_______ &lt;&lt; ((((___ &lt;&lt; __) - _) &lt;&lt; __) + _)) + (_______ &lt;&lt; (((((_ &lt;&lt; ___) + _)) &lt;&lt; __))) - ((((((_ &lt;&lt; ___) + _)) &lt;&lt; __) + _) &lt;&lt; ((((___ &lt;&lt; __) + _) &lt;&lt; _))) + (((_______ &lt;&lt; __) - _) &lt;&lt; (((((_ &lt;&lt; ___) + _)) &lt;&lt; _))) + (((___ &lt;&lt; ___) + _) &lt;&lt; ((_____ &lt;&lt; _))) + (_____ &lt;&lt; ______) + (_ &lt;&lt; ___)</span>
</code></pre></div>

<p>Stick this in as a replacement for <code>802616035175250124568770929992</code>, and put
all the parts together:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span>
    <span class="nb">getattr</span><span class="p">(</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="bp">True</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">__</span><span class="p">]),</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__eq__</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[:</span><span class="n">__</span><span class="p">]</span> <span class="o">+</span>
        <span class="p">()</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">[</span><span class="n">_____</span><span class="p">:</span><span class="n">________</span><span class="p">]</span>
    <span class="p">)(</span>
        <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
                <span class="nb">chr</span><span class="p">(</span><span class="n">___</span> <span class="o">%</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span> <span class="o">//</span> <span class="n">__</span><span class="p">)</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span>
                <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_lnotab</span><span class="p">,</span>
            <span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">________</span><span class="p">,</span>
            <span class="p">(((</span><span class="n">_____</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">_____</span><span class="p">)</span> <span class="o">-</span> <span class="n">___</span><span class="p">))</span> <span class="o">+</span> <span class="p">(((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">_____</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span>
            <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span>
            <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">______</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span>
            <span class="p">((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">____</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span>
            <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="p">((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">_______</span>
            <span class="o">&lt;&lt;</span> <span class="p">(((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)))</span> <span class="o">-</span> <span class="p">((((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">_______</span> <span class="o">&lt;&lt;</span> <span class="n">__</span><span class="p">)</span> <span class="o">-</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span>
            <span class="p">(((((</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(((</span><span class="n">___</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span> <span class="o">+</span> <span class="n">_</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">_____</span> <span class="o">&lt;&lt;</span>
            <span class="n">_</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">_____</span> <span class="o">&lt;&lt;</span> <span class="n">______</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">_</span> <span class="o">&lt;&lt;</span> <span class="n">___</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)(</span>
    <span class="o">*</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">))(</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span>
            <span class="p">[</span><span class="n">__</span><span class="p">(</span><span class="n">___</span><span class="p">[(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">])]</span> <span class="o">+</span>
            <span class="n">_</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">[(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_nlocals</span><span class="p">:])</span> <span class="k">if</span> <span class="n">___</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">),</span>
        <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">func_code</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">,</span>
        <span class="p">(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="p">,</span> <span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">________</span><span class="p">:</span> <span class="n">_</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>And there you have it.</p>

    </div>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'earwig';
        var disqus_identifier = '/2014/06/01/obfuscating-hello-world';
        var disqus_title = 'Obfuscating "Hello world!"';
        var disqus_url = 'http://earwig.github.com/2014/06/01/obfuscating-hello-world.html';
        var disqus_developer = 1;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

            <div id="footer">
                <p>Copyright &copy; 2011&ndash;2014 Ben Kurtovic &bull; <a href="//github.com/earwig/earwig.github.com">View Source</a> &bull; <a href="http://validator.w3.org/check?uri=referer">Valid HTML5</a></p>
            </div>
        </div>
    </body>
</html>
